# Build Bitcoin Core on Ubuntu Focal Fossa

This article describes how to clone, configure, make and install Bitcoin Core on a newly installed Ubuntu 20.02 Focal Fossa operating system.

Install Required Build Tools
----------------------------

Install the required build tools, as outlined in `doc/build-unix.md`:

```bash
sudo apt-get install build-essential libtool autotools-dev automake pkg-config bsdmainutils python3
```

Dependencies
------------
Bitcoin Core has a number of dependencies - you can either install them system-wide or build them yourself. 

The latter option may be best if you need to ensure compatibility with wallets generated by the distributed binaries, which are compiled with BerkeleyDB 4.8. This is incompatible with the version of BerkeleyDB distributed by Ubuntu - which is likely to be version 5.1 or greater. I've also had problems in the past with incompatible Boost library versions. If you self-build dependencies, you avoid all incompatibility hassles. On the other hand, the build process for dependencies adds to the total build time considerably.

If you are building from self-compiled dependencies, skip the "install required dependencies" in the Bitcoin Core `build-unix.md` instructions.

Build Dependencies
-----------------
To build dependencies for the current architecture & OS, move into the `depends` subdirectory and:

1. Install dependencies, required for the build process.
2. Run `make`:

```bash
sudo apt-get install make automake cmake curl g++-multilib libtool binutils-gold bsdmainutils pkg-config python3 patch
cd ~/bitcoin/depends
make
```

Some of the dependencies may already have been installed - if this is the case, they will be ignored by `apt-get` (or `apt`) so don't worry about it.

At this point you may want to go and make a cup of tea because this step is going to take some time. Amongst other packages, this process downloads and builds:

* Berekely DB 4.8.3
* Boost 1.70.0
* QT
* QR Encode

Once the process has finished, you will have an architecture/OS specific directory in the `depends` subdirectory.

In the case of Ubuntu 20.04 on a modern PC with an x86 processor, this will likely be in a directory named `x86_64-pc-linux-gnu`.



Configure
---------
The `configure` command creates the necessary Makefiles.

The script guesses values for system dependent variables. If you have built dependencies (I recommend this if building for Ubuntu), you need to set the `--prefix` command option to the directory that was created when building dependencies (i.e. when `make` was run in the `depends` sub-directory).

```bash
# From the bitcoin core directory
./configure --prefix=$PWD/depends/x86_64-pc-linux-gnu
```
If the `config` script completes successfully, you are ready to run `make` to build the executables.

Make
----


Make bitcoind & bitcoin-qt System Commands
------------------------------------------
This can be achieved by symlinking the executables in a directory that is present in your command search path: `$PATH`.

For our purposes, `usr/local/bin` is a good choice:

```bash
sudo ln -s ~/bitcoin/src/bitcoin{d,-cli} /usr/local/bin
sudo ln -s ~/bitcoin/src/qt/bitcoin-qt /usr/local/bin
```


```bash
# Install dependencies

sudo apt install git

# Install Bitcoin
git clone https://github.com/bitcoin/bitcoin.git

cd bitcoin

# Install Dependencies
# Build requirements:
sudo apt-get install build-essential libtool autotools-dev automake pkg-config bsdmainutils python3

# Install required dependencies
sudo apt-get install libevent-dev libboost-system-dev libboost-filesystem-dev libboost-test-dev libboost-thread-dev

# If installing the BerkeleyDB from Ubuntu repositories:
sudo apt-get install libdb-dev libdb++-dev

# OPtional: upnpc
sudo apt-get install libminiupnpc-dev

Optional ZMQ:
sudo apt-get install libzmq3-dev

For GUI:
sudo apt-get install libqt5gui5 libqt5core5a libqt5dbus5 qttools5-dev qttools5-dev-tools

For QR Code support
sudo apt-get install libqrencode-dev

# Generate config script
./autogen.sh

# Configure, with incompatible BerkeleyDB
./configure --with-incompatible-bdb

# If debugging symbols not required, amend compile flags:
./configure --with-incompatible-bdb CXXFLAGS="-O2"

#... lot's of checking...

# Make
make

# Install - sudo is required to install binaries in /usr/local/bin
sudo make install 
```
